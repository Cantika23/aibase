<div class="chat-interface">
  <!-- Chat Container -->
  <div class="chat-container flex flex-col items-stretch">
    <!-- Header with connection status -->
    <div class="chat-header border-b border-gray-200 bg-gray-50/50 px-6 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div
            class="connection-status flex items-center space-x-2 text-sm"
            [ngClass]="statusClass"
          >
            <span class="status-dot h-2 w-2 rounded-full"></span>
            <span class="status-text font-medium">{{ statusText }}</span>
            <span *ngIf="connectionState.clientId" class="client-id text-gray-500">
              â€¢ {{ connectionState.clientId.slice(-8) }}
            </span>

            <!-- Clear Button -->
            <button
              (click)="clearHistory()"
              [disabled]="messages.length === 0"
              class="inline-flex cursor-pointer items-center justify-center rounded-md text-sm font-medium text-gray-700 transition-colors hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-8 px-3"
            >
              <svg class="mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                ></path>
              </svg>
              Clear
            </button>
          </div>
        </div>
        <div class="flex items-center space-x-2">
          <!-- Connect Button -->
          <button
            *ngIf="connectionState.status === 'disconnected' || connectionState.status === 'error'"
            (click)="reconnect()"
            class="inline-flex items-center justify-center rounded-md text-sm font-medium bg-blue-600 text-white transition-colors hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-8 px-3"
          >
            <svg class="mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"
              ></path>
            </svg>
            Connect
          </button>

          <!-- Disconnect Button -->
          <button
            *ngIf="connectionState.status === 'connected'"
            (click)="disconnect()"
            class="inline-flex items-center justify-center rounded-md text-sm font-medium border border-gray-300 bg-white text-gray-700 transition-colors hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-8 px-3"
          >
            <svg class="mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"
              ></path>
            </svg>
            Disconnect
          </button>
        </div>
      </div>
    </div>

    <!-- Messages Container -->

    <div class="flex flex-1 flex-col items-center overflow-auto" id="chatContainer">
      <zard-message-list
        class="flex-1 flex flex-col relative w-full md:w-[700px]"
        [messages]="messages"
        [showTimestamps]="true"
        [isTyping]="isTyping"
        [isLoadingHistory]="isLoadingHistory"
        [messageOptions]="messageOptionsFunction"
        [autoScroll]="true"
        [scrollBehavior]="'smooth'"
      >
      </zard-message-list>
    </div>

    <!-- Input Area -->
    <div
      class="chat-input-area border-0 border-t border-gray-200 bg-gray-50/30 p-4 flex flex-col items-center"
    >
      <zard-message-input
        class="relative w-full md:w-[700px]"
        [(value)]="messageText"
        [(files)]="attachedFiles"
        [isGenerating]="isGenerating"
        [options]="messageInputOptions"
        [disabled]="connectionState.status !== 'connected'"
        (submit)="onMessageSubmit($event)"
        (stop)="onStopGeneration()"
        (filesChange)="onFilesChange($event)"
        (fileSelect)="onFileSelect($event)"
        (transcribeAudio)="onTranscribeAudio($event)"
      ></zard-message-input>
    </div>
  </div>
</div>
